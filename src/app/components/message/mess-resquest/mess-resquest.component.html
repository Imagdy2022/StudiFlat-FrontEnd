<!-- start header  -->
<header>
    <app-head (newItemEvent)="addItem($event)" [titleModule]="'Ticket'"></app-head>
</header>
<!-- end header  -->

<div class="row m-0">
    <!-- start sidebar  -->
    <app-sidebar class="col-lg-2" [showSide]="showSide" [titlepage]="'messages'"></app-sidebar>
    <!-- end sidebar  -->
    <!-- start content page  -->
    <main class="p-4 col-lg-10" (click)=" hidecard( )">
        <p class="fw-bold" style="color: #6c6a6a">Ticket : {{deatail?.ticket_Code}}</p>
        <div class="mt-3 row border bg-white rounded-3">
            <!-- persons active -->
            <!-- <div class="col-12 col-md-4 border-end"> -->
            <!-- <div class="d-flex justify-content-between">

                    <div class="d-flex mx-2 mt-4">
                        <p class="me-2 fs-5 fw-bold">Messages</p>
                        <p class="mt-1 bg-gray rounded-5 px-1 d-flex align-items-center">
                            16
                        </p>
                    </div>

                    <div class="d-flex align-items-center">
                        <img src="assets/images/message/Vector.svg" />
                    </div>
                </div> -->
            <!-- start search button -->
            <!-- <div class="p-input-icon-left w-100">
                    <i *ngIf="value == ''" class="me-1"><img src="assets/images/message/search-lg.svg" /></i>
                    <input class="form-control border rounded-3 mt-2 ps-35px" [class.ps-35px]="value == ''" type="text" pInputText placeholder="Search" [(ngModel)]="value" />
                </div> -->
            <!-- end search button -->
            <!-- <table class="table">
                    <tbody>
                        <tr>
                            <th scope="row">
                                <button class="outline-0 border-0 bg-transparent ">
                  <div class="d-flex justify-content-between">
                    <div class="d-flex">
                      <img *ngIf="activePerson" src="assets/images/message/Dot.svg" class="me-2" />
                      <img src="assets/images/Avatar.svg" class="me-3" />
                      <div class="ml-3 d-flex justify-content-between">
                        <div class="mt-3">
                          <p class="line-height fw-bold mb-0">Umar</p>
                          <p class="color-gray fw-light">@umar</p>
                        </div>
                      </div>
                    </div>
                    <p class="d-flex align-items-center fw-light">5min ago</p>
                  </div>
                  <p class="container fw-light">
                    Hey Loram, Ipsum sent me over the latest doc. I just have a
                    quick question about the...
                  </p>
                </button>

                            </th>
                        </tr>
                        <tr>
                            <th scope="row">
                                <button class="outline-0 border-0 bg-transparent ">
                  <div class="d-flex justify-content-between">
                    <div class="d-flex">
                      <img *ngIf="!activePerson" src="assets/images/message/Dot.svg" class="me-2" />
                      <img src="assets/images/Avatar.svg" class="me-3" />
                      <div class="ml-3 d-flex justify-content-between">
                        <div class="mt-3">
                          <p class="line-height fw-bold mb-0">Umar</p>
                          <p class="color-gray fw-light">@umar</p>
                        </div>
                      </div>
                    </div>
                    <p class="d-flex align-items-center fw-light">5min ago</p>
                  </div>
                  <p class="container fw-light">
                    Hey Loram, Ipsum sent me over the latest doc. I just have a
                    quick question about the...
                  </p>
                </button>
                            </th>
                        </tr>
                    </tbody>
                </table> -->
            <!-- </div> -->
            <!-- start the chat -->
            <p-toast></p-toast>

            <div class="col-12 col-md-12 px-0">
                <!-- start head in the chat-->
                <div class="border py-2 px-3">

                    <div class="d-flex justify-content-between">
                        <div class="d-flex">
                            <!-- <img style="height: 50px;width: 50px;border-radius: 46%;margin-right: 9px; cursor: pointer;margin-top: 13px;" [src]="deatail?.userPhoto" class="me-3" /> -->

                            <img *ngIf="deatail?.userPhoto" class="me-3" [src]="deatail?.userPhoto" style="height: 50px;width: 50px;border-radius: 46%;margin-right: 9px; cursor: pointer;margin-top: 13px;">


                            <img *ngIf="!deatail?.userPhoto" class="me-3" src="../../../assets/images/Frame 1261154899.svg" style="height: 50px;width: 50px;border-radius: 46%;margin-right: 9px;cursor: pointer;margin-top: 13px;">

                            <div class="ml-3 d-flex justify-content-between">
                                <div class="mt-3">
                                    <p class="line-height fw-bold mb-0">{{deatail?.userName}}</p>
                                    <p class="color-gray fw-light">@{{deatail?.userName}}</p>
                                </div>
                                <!-- <span class="d-flex align-items-center m-0 ms-4 rounded-4 px-2 mt-3" style="background-color: #ecfdf3; height: 20px; color: green">
                  <img src="assets/images/message/_Dot.svg" class="me-2" />
                  Online</span> -->
                            </div>
                        </div>
                        <div class="d-flex">
                            <td class="cursor position-relative">
                                <button class="border-0 outlin-0 bg-transparent" *ngIf="deatail?.status=='Opened'" (click)="detailperson($event,deatail?.ticket_ID)">
          <img src="assets/images/edit.svg">
      </button>
                                <div *ngIf="showEdit[deatail?.ticket_ID] " style="width: 220px; line-height: 10px;  z-index: 999;   right: 20px;" class="position-absolute z-3 rounded-3 bg-white border edit-button">
                                    <button class="d-block border-0 outlin-0 bg-transparent my-2 button text-start py-2 w-100" routerLink="/assgin-tiket/{{deatail?.ticket_ID}}">reassign ticket to employee</button>

                                    <button class="d-block border-0 outlin-0 bg-transparent button w-100 text-start py-2" (click)="CloseTicket('Closed')">close ticket  </button>
                                    <button class="d-block border-0 outlin-0 bg-transparent button w-100 text-start py-2" (click)="CloseTicket('Resolved')"> solved  ticket </button>

                                </div>

                            </td>
                            <!-- <a routerLink="" class="text-decoration-none bg-blue text-white h-35 d-none d-md-flex align-items-center rounded mt-3 py-2 px-3 text-center" style="color: #6c6a6a">View profile</a>
                            <button class="bg-transparent mb-2 border-0">
                <img src="assets/images/more_vert_FILL.svg " />
              </button> -->
                        </div>
                    </div>

                </div>
                <!-- end head in the chat-->
                <!-- start content in the chat-->
                <div class="px-4">
                    <div *ngFor=" let item of deatail?.reply">
                        <!-- Reciver -->
                        <div class="d-flex justify-content-between reciver mb-2 py-4" *ngIf="item?.reply_From==true">
                            <div class="d-flex">
                                <!-- <img src="assets/images/Avatar.svg" class="me-3 mb-3" /> -->
                                <img *ngIf="deatail?.userPhoto" style="height: 50px;width: 50px;border-radius: 46%;margin-right: 9px; cursor: pointer;margin-top: 13px;" [src]="deatail?.userPhoto" class="me-3" />
                                <img *ngIf="!deatail?.userPhoto" class="me-3" src="../../../assets/images/Frame 1261154899.svg" style="height: 50px;width: 50px;border-radius: 46%;margin-right: 9px; cursor: pointer;margin-top: 13px;">

                                <div>
                                    <div class="ml-3 d-flex justify-content-between">
                                        <div>
                                            <p class="mb-0">{{item?.reply_User}}</p>
                                        </div>
                                        <p class="mb-0 fw-light" style="margin-left: 70px;">{{item?.date_Time| date : "EEEE hh:mm:ss a" }}</p>
                                    </div>
                                    <p *ngIf="item?.reply_Desc!=null && item?.reply_Desc!=''" class="p-2 rounded-end rounded-bottom" style="background-color: #f6f6f6">
                                        {{item?.reply_Desc}}
                                    </p>
                                    <img (click)="openmodel(item?.reply_Attach)" style="width: 70px;  height: 70px" *ngIf="item?.reply_Attach!=null && item?.reply_Attach!=''" [src]="item?.reply_Attach">
                                </div>
                            </div>
                        </div>
                        <!-- Sender -->
                        <div class="d-flex justify-content-end" *ngIf="item.reply_From!=true">
                            <div style="margin-bottom: 20px;">
                                <div class="ml-3 d-flex justify-content-between">
                                    <div>
                                        <p class="mb-0">You</p>
                                    </div>
                                    <p class="mb-0 fw-light">{{item?.date_Time}}</p>
                                </div>
                                <p *ngIf="item?.reply_Desc!=null && item?.reply_Desc!=''" class="p-2 rounded-start rounded-bottom text-white bg-blue">
                                    {{item?.reply_Desc}}
                                </p>
                                <img (click)="openmodel(item?.reply_Attach)" style="width: 70px;  height:70px" *ngIf="item?.reply_Attach!=null && item?.reply_Attach!=''" [src]="item?.reply_Attach">

                            </div>
                        </div>
                    </div>
                    <div class="position-relative mb-2 h-25 m-auto" style="width: 98%">
                        <textarea [(ngModel)]="reply_Desc" id="w3review" name="w3review" class="w-100 h-100 p-3 border rounded" placeholder="Send a message" style="resize: none; outline: none"></textarea>
                        <div class="position-absolute d-flex justify-content-between" style="right: 6%; bottom: 15%">
                            <!-- <button class="border-0 bg-transparent"> -->
                            <input type="file" accept="image/*" (change)="selectFile($event)" style=" width: 28% !important;" class="ng-star-inserted d-block w-100 h-124px file position-absolute">

                            <img src="assets/images/message/attach_file.svg" />
                            <!-- </button> -->
                            <button class="border-0 bg-transparent">
                <img src="assets/images/message/more.svg" />
              </button>
                            <button (click)="ReplyDash() " class="text-center px-3 py-1 rounded bg-blue text-white">
                <img src="assets/images/message/sendFill.svg" /> Send
              </button>
                        </div>
                    </div>
                </div>
                <!-- end content in the chat-->
                <!-- start send a message in the chat-->

                <!-- end send a message in the chat-->
            </div>
            <!-- end the chat-->
        </div>
    </main>
    <!-- end content page  -->
</div>
<div class="modal" tabindex="-1" role="dialog" [ngStyle]="{'display':display22}" style="background-color: rgba(90,90,90,0.5);">
    <div class="modal-dialog" role="document">
        <div class="modal-content">


            <div class="modal-body">
                <img [src]="imageSize" style="width:70%" />

            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-white bbtclose" (click)="oncloseModal()">
close
</button>

            </div>


        </div>
    </div>
</div>
